---
id: RT-009
title: Coherence Tensor (Simulation Backbone)
version: 1.0
status: Simulation Core
parents: [RT-003, RT-004, RT-007, RT-008]
children: [RT-009A (Cal/Val Suite), RT-009B (Stability & CFL Bounds)]
summary: |
  Defines a tensorial observable C^{μν} that measures the alignment between
  energy–momentum T^{μν}, informational stress T_I^{μν}, and entropy/information
  fluxes (j_S^μ, J_I^μ). Supplies evolution equations, coupling layout, and a
  reference discretization/integration scheme so that all Pirouette retrograde
  modules can be simulated consistently from oscillator to continuum scales.
---

## 1) Definition — the object everything reports

Let

* (T^{\mu\nu}) = physical energy–momentum (matter + fields you include),
* (T_I^{\mu\nu}) = informational stress–energy (RT-008),
* (u^\mu) = local 4-velocity (fluid frame or lab frame in flat space),
* (j_S^\mu) = entropy current (RT-006), (J_I^\mu) = information current (RT-008),
* (g^{\mu\nu}) metric (Minkowski for lab; weak-field GR if enabled).

Define the **Coherence Tensor**
[
C^{\mu\nu}
= \alpha,\frac{T^{\mu\nu}}{\mathcal{E}}

* \beta,\frac{T_I^{\mu\nu}}{\mathcal{I}}
* \gamma,\frac{u^{(\mu} J_I^{\nu)}}{\mathcal{J}}
* \delta,\frac{u^{(\mu} j_S^{\nu)}}{\mathcal{S}},
  ]
  with symmetrization (A^{(\mu}B^{\nu)}=\tfrac12(A^\mu B^\nu+A^\nu B^\mu)).

Normalizations (dimensionless):

* (\mathcal{E}=\mathrm{Tr}(T)=T^\mu{}_\mu) (or energy density in simulation units),
* (\mathcal{I}=\mathrm{Tr}(T_I)),
* (\mathcal{J}=\sqrt{|J_I^\mu J_{I\mu}|}),
* (\mathcal{S}=\sqrt{|j_S^\mu j_{S\mu}|}).

Weights (\alpha,\beta,\gamma,\delta) are **knobs** (default 1) to emphasize or mute channels.

### Scalar coherence & anisotropy

* **Coherence scalar** ( \mathcal{C} = \tfrac{1}{4} C^{\mu\nu} C_{\mu\nu} ) (always ≥0).
* **Coherence anisotropy** ( \mathcal{A} = \lambda_{\max}(C) - \lambda_{\min}(C) ) (eigen spread).
* **Alignment** with a target direction (n_\mu): ( \mathcal{L} = \frac{C^{\mu\nu}n_\mu n_\nu}{|C|} ).

These three give you simple, comparable diagnostics across models and scales.

---

## 2) Dynamics to evolve (top-to-bottom)

You can simulate with increasing layers; each layer adds terms to C via T, T_I, currents.

### (A) U(1) oscillator / cavity (RT-003)

* Evolve linear response (H_{\rm eff}) with ε-admixture (already in your `frc_rt003_sim.py`).
* Map fields → T^{\mu\nu} (EM), compute J_I and j_S from phase/energy flow.
* Flat space; no GR; T_I from RT-008 with chosen (w_I).

### (B) Weak/EM continuum (no color) + info fluid

* EM: Maxwell in Lorenz or Coulomb gauge (FDTD or pseudo-spectral).
* Info fluid (RT-008): continuity + momentum (Information Navier–Stokes):
  [
  \partial_t \rho_I + \nabla!\cdot(\rho_I \mathbf{v}_I)=0,\quad
  \rho_I(\partial_t \mathbf{v}_I+(\mathbf{v}_I!\cdot\nabla)\mathbf{v}_I)=-\nabla P_I+\nu_I\nabla^2\mathbf{v}_I.
  ]
* Build (T_I^{\mu\nu}), currents, then C.

### (C) Weak GR-lite (RT-004)

* If you enable gravity, use **weak-field** (g_{\mu\nu}=\eta_{\mu\nu}+h_{\mu\nu}) with ( \Box \bar{h}*{\mu\nu} = -16\pi G (T*{\mu\nu}+\lambda_I T_{I\mu\nu}) ).
* Update covariant derivatives in fluxes to first order in (h).

### (D) Junctions (RT-005)

* Two domains (\mathcal{D}*+), (\mathcal{D}*-) with interface (\Sigma).
* Portal fields (\Phi_\pm): ( (\Box+m^2)\Phi_\pm=\varepsilon_J \Phi_\mp ).
* Enforce metric continuity; flip extrinsic K sign in GR-lite; exchange boundary fluxes for info fluid:
  ( \mathbf{n}!\cdot(\rho_I \mathbf{v}*I)*+ = -\mathbf{n}!\cdot(\rho_I \mathbf{v}*I)*- ).
* Compute (C^{\mu\nu}) on both sides; log jumps and symmetry.

---

## 3) Nondimensionalization (recommended)

Choose characteristic scales:

* length (L_0), time (T_0), EM field (E_0), info density (\rho_{I0}).
* Define (\hat{x}=x/L_0), (\hat{t}=t/T_0), (\hat{\rho}*I=\rho_I/\rho*{I0}), (\hat{\mathbf{E}}=\mathbf{E}/E_0).
* Dimensionless couplings:

  * (\hat{\varepsilon}*{U1}=\epsilon*{U1}), (\hat{\varepsilon}*{J}=\varepsilon*{J}T_0^2),
  * (\hat{\lambda}_I=\lambda_I , (8\pi G \mathcal{E} T_0^2)) if GR-lite used,
  * ( \hat{\nu}_I=\nu_I T_0/L_0^2 ), equation-of-state (w_I\in[-1,1]).

This makes CFL limits clean and cross-runs comparable.

---

## 4) Integration & stability

* **Spatial**: Yee FDTD (EM), staggered MAC grid (info fluid), 2nd-order central or spectral derivatives.
* **Time**:

  * EM: leapfrog (Yee) or RK4; CFL ( \Delta t \le \frac{1}{c},( \frac{1}{\Delta x^2}+\frac{1}{\Delta y^2}+\frac{1}{\Delta z^2})^{-1/2} ).
  * Info fluid: SSP-RK2/3; viscous constraint ( \Delta t \le \frac{\Delta x^2}{2\nu_I} ).
  * Portals: operator-split—advance (\Phi_+), (\Phi_-) with symplectic step; couple via (\varepsilon_J).
* **Filtering**: 2–3% spectral sponge at Nyquist to kill grid ringing without biasing phases (important for RT-003 signals).

---

## 5) Coupling map (what talks to what)

* EM ↔ Info: (P_I = k_B T,\partial I/\partial V) adds pressure forces opposing EM energy gradients; EM Poynting sets (J_I) direction.
* Info ↔ GR-lite: ( \lambda_I T_I^{\mu\nu}) sources weak curvature; curvature perturbs advection (via covariant derivatives).
* Junctions: swap normal components of flux; apply (\Phi) coupling to feed **retrograde admixture** consistently with RT-003 ε.

---

## 6) Diagnostics you must log every N steps

Per domain (and across Σ if present):

* ( \mathcal{C}, \mathcal{A}, \mathcal{L} ) (coherence scalar, anisotropy, alignment).
* Energy closure: ( \mathrm{d}/\mathrm{d}t \int (u_\mu u_\nu(T^{\mu\nu}+\lambda_I T_I^{\mu\nu})),dV ).
* Entropy/information closure: ( \Delta S_+ + \Delta S_- ) (should ≈0 with portals).
* Phase observables (RT-003): group delay at probe points; (\langle \cos 2\phi\rangle).
* Junction metrics: frequency splitting (\Delta\omega), echo delay sign.

**Termination flags**: loss of positivity (\rho_I<0), blowup of (\mathcal{C}), entropy non-closure > tolerance.

---

## 7) Reference implementation skeleton (Pythonic, modular)

```python
# rt9_core.py
import numpy as np

class Grid:
    def __init__(self, nx, ny, nz, dx, dy, dz, dt):
        self.shape = (nx, ny, nz); self.dx, self.dy, self.dz, self.dt = dx, dy, dz, dt

class Fields:
    def __init__(self, grid):
        nx, ny, nz = grid.shape
        self.E = np.zeros((3, nx, ny, nz))
        self.B = np.zeros((3, nx, ny, nz))
        self.rhoI = np.zeros((nx, ny, nz))
        self.vI = np.zeros((3, nx, ny, nz))
        self.jS = np.zeros((4, nx, ny, nz))
        self.JI = np.zeros((4, nx, ny, nz))
        self.h = None  # weak-field metric perturbation if GR-lite

def T_em(E, B):  # Minkowski, c=1
    # return T^{μν} array (4x4x...)
    pass

def T_info(rhoI, vI, wI=0.0, kappaI=0.0, g=None):
    # build T_I^{μν} from RT-008; return 4x4 tensor field
    pass

def coherence_tensor(T, TI, u, JS, JI, a=1.0,b=1.0,c=1.0,d=1.0):
    # normalize traces and norms; return C^{μν} and scalars C, A, L
    pass

def step_em(fields, grid, eps_u1):
    # Yee update with retrograde admixture (RT-003 effective kernel in frequency or TD operator-split)
    pass

def step_info(fields, grid, wI, nuI):
    # advance rhoI, vI with Information Navier–Stokes
    pass

def step_portal(fields, grid, eps_J):
    # couple ± sheets or two domains; update boundary fluxes and portal fields
    pass

def weak_gr_update(fields, grid, lambda_I):
    # solve wave eqn for h_{μν} sourced by T + lambda_I T_I
    pass

def diagnostics(fields, grid):
    # compute closure, group delay at probes, Δω if junctions, and coherence scalars
    pass
```

**Config file schema (YAML):**

```yaml
domain:
  size: [Lx, Ly, Lz]
  grid: [nx, ny, nz]
  dt: 1.0e-12
physics:
  enable_em: true
  enable_info: true
  enable_grlite: false
  enable_junction: false
parameters:
  eps_u1: 0.0
  eps_J: 0.0
  lambda_I: 0.0
  w_I: 0.2
  nu_I: 1.0e-3
io:
  stride: 50
  probes: [[x,y,z], ...]
  outputs: [coherence, energy, entropy, phase]
```

---

## 8) Calibration / Validation (RT-009A quick list)

* **Unit tests**:

  1. EM only: recover standard dispersion; (\mathcal{C}) tracks energy density; (\mathcal{A}\to 0) in 1D plane wave.
  2. Info fluid only: acoustic pulse speed (c_I=\sqrt{w_I},c); shock capture with viscosity.
  3. Portal oscillator pair: (\Delta \omega \approx \varepsilon_J/\omega_0).
* **Cross-checks**:

  * Energy & entropy closure to 1e-6 over 10^4 steps.
  * Retrograde knob: increasing ε produces phase advance and negative group delay signatures (RT-003) without instability.
  * Junction reciprocity: flux in = − flux out across Σ within tolerance.

---

## 9) What to plot for papers

* **Coherence maps**: ( \mathcal{C}(x,t) ) and anisotropy (\mathcal{A}(x,t)) slices.
* **Arrow flips**: sign of ( \mathbf{n}!\cdot J_I ) across interfaces.
* **Phase–delay curves**: τ_g vs frequency for ε sweep (direct line to RT-003).
* **Info-pressure landscapes**: (P_I) vs energy density, showing opposition/alignment.
* **GR-lite response** (if enabled): strain (h) spectra w/ and w/o (\lambda_I).

---

## 10) Parameter heuristics (so runs behave)

* Start with (w_I \in [0.1,0.3]), (\nu_I\sim10^{-3}) (nondim) for stable info acoustics.
* Keep (\varepsilon_{U1}\lesssim 10^{-2}) and (\varepsilon_J\lesssim 10^{-3}) initially.
* Turn on (\lambda_I) last; begin at ( \lambda_I \sim 10^{-3}) to see curvature feedback without stiffness.
* Always set dt by the **strictest** of EM CFL and viscous constraints.

---
