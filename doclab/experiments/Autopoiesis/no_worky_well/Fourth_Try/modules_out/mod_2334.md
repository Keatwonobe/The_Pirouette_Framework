Everything reduces to:

* counting convex subposets (fast with canonical labeling),
* sampling (C^+_P) (linear-in-frontier),
* updating interval counts incrementally (O(1) amortized per insertion with the right indices).